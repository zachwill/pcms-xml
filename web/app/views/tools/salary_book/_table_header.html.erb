<%# TableHeader — Tailwind port of the React prototype %>

<% salary_years ||= SalaryBookHelper::SALARY_YEARS %>
<% team_code = local_assigns.fetch(:team_code) %>

<div class="border-b border-border bg-background">
  <div
    class="h-8 flex items-center text-xs font-medium text-muted-foreground select-none cursor-default"
  >
    <%# Player column (sticky left) %>
    <div
      class="w-52 shrink-0 pl-4 sticky left-0 z-20 bg-background relative
             after:absolute after:right-0 after:top-0 after:bottom-0 after:w-px after:bg-border/50"
    >
      <div class="grid grid-cols-[40px_1fr] items-center h-full">
        <div></div>
        <div class="pl-1">Name / Details</div>
      </div>
    </div>

    <%# EPM + Year columns
        Hover/focus previews a year; click toggles lock on that year. %>
    <div
      class="h-full flex shrink-0"
      data-on:salarybook-setseason="if (!($seasonlocked && $selectedseasonteam === '<%= team_code %>')) { const nextyear = String(evt.detail.year); if ($activeteam !== '<%= team_code %>') { $activeteam = '<%= team_code %>'; }; if ($selectedseasonteam !== '<%= team_code %>') { $selectedseasonteam = '<%= team_code %>'; }; if ($selectedseason !== nextyear) { $selectedseason = nextyear; } }"
      data-on:mouseleave="if (!$seasonlocked && $selectedseasonteam === '<%= team_code %>' && $selectedseason !== '') { $selectedseason = ''; $selectedseasonteam = ''; }"
      data-on:focusout="if (!$seasonlocked && evt.relatedTarget && !el.contains(evt.relatedTarget) && $selectedseasonteam === '<%= team_code %>' && $selectedseason !== '') { $selectedseason = ''; $selectedseasonteam = ''; }"
    >
      <div
        class="w-24 h-full shrink-0 flex items-center justify-center text-[10px] font-semibold uppercase tracking-wide text-muted-foreground"
        data-show="$displayepm"
      >EPM</div>
      <% salary_years.each do |year| %>
        <div
          class="w-24 h-full shrink-0 flex items-center justify-center tabular-nums text-center transition-colors duration-100 cursor-pointer select-none"
          title="Hover to preview season · click to lock"
          data-on:mouseenter="el.dispatchEvent(new CustomEvent('salarybook-setseason', { detail: { year: '<%= year %>' }, bubbles: true }))"
          data-on:focusin="el.dispatchEvent(new CustomEvent('salarybook-setseason', { detail: { year: '<%= year %>' }, bubbles: true }))"
          data-on:click="const samecell = ($selectedseasonteam === '<%= team_code %>' && $selectedseason === '<%= year %>'); if (samecell && $seasonlocked) { $seasonlocked = false; $selectedseason = ''; $selectedseasonteam = ''; } else { if ($activeteam !== '<%= team_code %>') { $activeteam = '<%= team_code %>'; } $selectedseasonteam = '<%= team_code %>'; $selectedseason = '<%= year %>'; $seasonlocked = true; }"
          data-class="{ 'bg-yellow-50/70 dark:bg-yellow-900/10 text-foreground': $selectedseason === '<%= year %>' && $selectedseasonteam === '<%= team_code %>' }"
        ><%= format_year_label(year) %></div>
      <% end %>
    </div>

    <%# Total column %>
    <div class="w-24 shrink-0 tabular-nums text-center font-semibold">Total</div>

    <%# Agent column %>
    <div class="w-40 shrink-0 text-center">Agent</div>
  </div>
</div>
